- _target_: models._utils.callbacks.TorchMetricsCallback
  metrics:
    # perplexity: 
    #   _target_: torchmetrics.text.perplexity.Perplexity
  - _target_: torchmetrics.text.perplexity.Perplexity
  get_preds: 
    _target_: models._core.decoder_llm.LLM_get_preds
    _partial_: true
  get_target: 
    _target_: data._utils.llm.LLM_get_target
    _partial_: true
  write_path: 'metrics.csv'
  hook_strings:
  - "on_validation_start"
  - "on_validation_epoch_end"
  - "on_validation_batch_end"
- _target_: lightning.pytorch.callbacks.EarlyStopping
  patience: 3
  monitor: validation_loss
  mode: min
  verbose: true
- _target_: lightning.pytorch.callbacks.ModelCheckpoint
#  dirpath: '/home/fultonwang/Documents/code/experimental/results/vae/results/test/checkpoints'
#  monitor: validation_loss
  every_n_train_steps: 3500 #2000
  save_top_k: -1